<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title><%= issue.title %> - CivicOne</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;background:#f5f7fa;color:#222}

    .navbar {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow:0 2px 10px rgba(0,0,0,0.1);
    }
    .navbar-brand { font-size:1.8em; font-weight:700; }
    .navbar-menu { display:flex; gap:30px; align-items:center; }
    .navbar-menu a { color:white; text-decoration:none; font-weight:500; }
    .navbar-menu a:hover{opacity:0.8;}

    .container{max-width:1000px;margin:40px auto;padding:0 20px;}
    .back-btn{display:inline-flex;align-items:center;gap:8px;color:#667eea;text-decoration:none;font-weight:600;margin-bottom:20px;transition:all 0.3s;}
    .back-btn:hover{gap:12px;}

    .issue-detail{background:white;border-radius:15px;overflow:hidden;box-shadow:0 2px 10px rgba(0,0,0,0.05);}
    .issue-image-large{width:100%;height:400px;object-fit:cover;background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);}
    .issue-content{padding:40px;}
    .issue-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:25px;flex-wrap:wrap;gap:20px;}
    .issue-title h1{color:#333;font-size:2.2em;margin-bottom:10px;}
    .issue-meta{display:flex;gap:15px;flex-wrap:wrap;font-size:0.95em;color:#888;}
    .badges{display:flex;gap:10px;flex-wrap:wrap;}
    .severity-badge{padding:8px 16px;border-radius:20px;font-size:0.9em;font-weight:600;text-transform:uppercase;}
    .severity-low{background:#d4edda;color:#155724;}
    .severity-medium{background:#fff3cd;color:#856404;}
    .severity-high{background:#f8d7da;color:#721c24;}
    .category-badge{padding:8px 16px;background:#e3f2fd;color:#1976d2;border-radius:20px;font-size:0.9em;font-weight:600;}

    .issue-description{margin:30px 0;padding:25px;background:#f8f9fa;border-radius:10px;border-left:4px solid #667eea;}
    .issue-description h2{color:#333;margin-bottom:15px;font-size:1.3em;}
    .issue-description p{color:#555;line-height:1.8;font-size:1.05em;}

    .info-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-top:30px;}
    .info-card{padding:20px;background:#f8f9fa;border-radius:10px;border:1px solid #e0e0e0;}
    .info-card h3{color:#333;margin-bottom:10px;font-size:1.1em;display:flex;align-items:center;gap:8px;}
    .info-card p{color:#666;font-size:1em;}

    .map-container{margin-top:30px;height:300px;background:#e0e0e0;border-radius:10px;display:flex;align-items:center;justify-content:center;color:#666;}

    @media(max-width:768px){
      .navbar{flex-direction:column;gap:20px;}
      .navbar-menu{flex-direction:column;gap:15px;}
      .issue-content{padding:25px;}
      .issue-title h1{font-size:1.8em;}
      .issue-image-large{height:250px;}
    }
  </style>
</head>
<body>
  <nav class="navbar">
    <div class="navbar-brand">üèõÔ∏è CivicOne</div>
    <div class="navbar-menu">
      <a href="/dashboard">Dashboard</a>
      <a href="/issues">View Issues</a>
      <a href="/issues/new">Report Issue</a>
      <a href="/upload">AI Analysis</a>
      <a href="/ai">AI Assistant</a>
      <a href="/account">My Account</a>
    </div>
  </nav>

  <div class="container">
    <a href="/issues" class="back-btn">‚Üê Back to All Issues</a>

    <div class="issue-detail">
      <% if(issue.imageUrl){ %>
        <img src="<%= issue.imageUrl %>" alt="Issue image" class="issue-image-large">
      <% } else { %>
        <div class="issue-image-large"></div>
      <% } %>

      <div class="issue-content">
        <div class="issue-header">
          <div class="issue-title">
            <h1><%= issue.title %></h1>
            <div class="issue-meta">
              <span>üìÖ Reported on <%= new Date(issue.createdAt).toLocaleDateString('en-US', {year:'numeric',month:'long',day:'numeric'}) %></span>
              <span>üÜî ID: <%= issue._id.toString().substring(0,8) %></span>
            </div>
          </div>
          <div class="badges">
            <span class="severity-badge severity-<%= issue.severity %>"><%= issue.severity %> Priority</span>
            <span class="category-badge"><%= issue.category %></span>
          </div>
        </div>

        <div class="issue-description">
          <h2>üìù Description</h2>
          <p><%= issue.description || 'No detailed description provided.' %></p>
        </div>

        <div class="info-grid">
          <div class="info-card"><h3>üìä Status</h3><p><%= issue.status || 'Pending' %></p></div>
          <div class="info-card"><h3>‚ö° Severity Level</h3><p><%= issue.severity.charAt(0).toUpperCase()+issue.severity.slice(1) %></p></div>
          <div class="info-card"><h3>üìÅ Category</h3><p><%= issue.category.charAt(0).toUpperCase()+issue.category.slice(1) %></p></div>
          <div class="info-card"><h3>üë§ Reporter</h3><p><%= issue.userId || 'Anonymous' %></p></div>
        </div>

        <% if(issue.location && issue.location.latitude && issue.location.longitude){ %>
          <div class="map-container">
            <div style="text-align:center;">
              <div style="font-size:3em;margin-bottom:10px;">üìç</div>
              <p>Location: <%= issue.location.latitude.toFixed(4) %>, <%= issue.location.longitude.toFixed(4) %></p>
              <p style="margin-top:10px;font-size:0.9em;">
                <a href="https://www.google.com/maps?q=<%= issue.location.latitude %>,<%= issue.location.longitude %>" target="_blank" style="color:#667eea;text-decoration:none;font-weight:600;">View on Google Maps ‚Üí</a>
              </p>
            </div>
          </div>
        <% } %>
      </div>
    </div>
  </div>
</body>
</html>
